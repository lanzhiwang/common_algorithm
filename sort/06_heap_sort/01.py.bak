#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
99 5 36 7 22 17 46 12

堆化

            99
          /    \
         5      36
        / \     / \
       7  22   17 46
      /
     12


                99-0
            /         \
          5-1        36-2
        /     \      /   \
       7-3  22-4   17-5 46-6
        /
      12-7

根据节点位置确定左右子节点位置
i -> 2i+1 2i+2
0 -> 1 2
1 -> 3 4
2 -> 5 6
3 -> 7 -1
4 -> -1 -1
5 -> -1 -1
6 -> -1 -1
7 -> -1 -1




"""

def heapify(unsorted, index, heap_size):
    largest = index
    left_index = 2 * index + 1
    right_index = 2 * index + 2

    if left_index < heap_size and unsorted[left_index] > unsorted[largest]:
        largest = left_index

    if right_index < heap_size and unsorted[right_index] > unsorted[largest]:
        largest = right_index

    if largest != index:
        unsorted[largest], unsorted[index] = unsorted[index], unsorted[largest]
        heapify(unsorted, largest, heap_size)


def heap_sort(unsorted):
    n = len(unsorted)  # 8
    for i in range(n // 2 - 1, -1, -1):  # (3, -1, -1) 3 2 1 0
        print('i: %s' % i)
        print('unsorted: %s' % unsorted)
        heapify(unsorted, i, n)  # 形成最大堆

    for i in range(n - 1, 0, -1):  # (7, 0, -1)  # 7 6 5 4 3 2 1
        print('i: %s' % i)
        print('unsorted: %s' % unsorted)
        unsorted[0], unsorted[i] = unsorted[i], unsorted[0]
        print('unsorted: %s' % unsorted)
        heapify(unsorted, 0, i)

        """
        i: 7
        unsorted: [99, 22, 46, 12, 5, 17, 36, 7]
        unsorted: [7, 22, 46, 12, 5, 17, 36, 99]
        i: 6
        unsorted: [46, 22, 36, 12, 5, 17, 7, 99]
        unsorted: [7, 22, 36, 12, 5, 17, 46, 99]
        i: 5
        unsorted: [36, 22, 17, 12, 5, 7, 46, 99]
        unsorted: [7, 22, 17, 12, 5, 36, 46, 99]
        i: 4
        unsorted: [22, 12, 17, 7, 5, 36, 46, 99]
        unsorted: [5, 12, 17, 7, 22, 36, 46, 99]
        i: 3
        unsorted: [17, 12, 5, 7, 22, 36, 46, 99]
        unsorted: [7, 12, 5, 17, 22, 36, 46, 99]
        i: 2
        unsorted: [12, 7, 5, 17, 22, 36, 46, 99]
        unsorted: [5, 7, 12, 17, 22, 36, 46, 99]
        i: 1
        unsorted: [7, 5, 12, 17, 22, 36, 46, 99]
        unsorted: [5, 7, 12, 17, 22, 36, 46, 99]
        """
    return unsorted


if __name__ == '__main__':
    user_input = '99 5 36 7 22 17 46 12'
    unsorted = [int(item) for item in user_input.split(' ')]
    print('source unsorted: %s' % unsorted)  # [99, 5, 36, 7, 22, 17, 46, 12]
    print(heap_sort(unsorted))  # [5, 7, 12, 17, 22, 36, 46, 99]
